import random
import math

#precompute the twiddle factors
w_rom = []
kesai = 7
# q = 12289
q = 3329
inv_kesai = pow(kesai,2047) % q  # inv_kesai = 8778
#print(inv_kesai)
# w_rom长度为1024 但实际上用到了1023个 1不是旋转因子
w_rom =  2642
# print(len(w_rom))


a = []
for i in range(0,128):
    a.append(i)


def DIT_NR_NTT(a,w_rom):
    n = len(a)
    # log_n = int(math.log(n,2))
    # r = 1
    # for p in range(log_n-1,-1,-1):
    #     J = int(pow(2,p))
    # for k in range(int(n/(64))):
    w = w_rom
    # r = r + 1
    for j in range(64):
        u = a[j] % q
        t = (a[j+64] * w) % q
        # print(a[j],a[j+256],u,t,w)
        a[j] = (u + t) % q
        a[j+64] = (u - t) % q
        # print(a[j],a[j+256])
    return a

radix2 = DIT_NR_NTT(a,w_rom)

print("ffta = ",radix2)

print(a[0:32])
print(a[32:64])
print(a[64:96])
print(a[96:128])


# print(len(radix2))
ffta=[2335, 857, 11668, 10190, 8712, 7234, 5756, 4278, 2800, 1322, 12133, 10655, 9177, 7699, 6221, 4743, 3265, 1787, 309, 11120, 9642, 8164, 6686, 5208, 3730, 2252, 774, 11585, 10107, 8629, 7151, 5673, 4195, 2717, 1239, 12050, 10572, 9094, 7616, 6138, 4660, 3182, 1704, 226, 11037, 9559, 8081, 6603, 5125, 3647, 2169, 691, 11502, 10024, 8546, 7068, 5590, 4112, 2634, 1156, 11967, 10489, 9011, 7533, 6055, 4577, 3099, 1621, 143, 10954, 9476, 7998, 6520, 5042, 3564, 2086, 608, 11419, 9941, 8463, 6985, 5507, 4029, 2551, 1073, 11884, 10406, 8928, 7450, 5972, 4494, 3016, 1538, 60, 10871, 9393, 7915, 6437, 4959, 3481, 2003, 525, 11336, 9858, 8380, 6902, 5424, 3946, 2468, 990, 11801, 10323, 8845, 7367, 5889, 4411, 2933, 1455, 12266, 10788, 9310, 7832, 6354, 4876, 3398, 1920, 442, 11253,
      9775, 8297, 6819, 5341, 3863, 2385, 907, 11718, 10240, 8762, 7284, 5806, 4328, 2850, 1372, 12183, 10705, 9227, 7749, 6271, 4793, 3315, 1837, 359, 11170, 9692, 8214, 6736, 5258, 3780, 2302, 824, 11635, 10157, 8679, 7201, 5723, 4245, 2767, 1289, 12100, 10622, 9144, 7666, 6188, 4710, 3232, 1754, 276, 11087, 9609, 8131, 6653, 5175, 3697, 2219, 741, 11552, 10074, 8596, 7118, 5640, 4162, 2684, 1206, 12017, 10539, 9061, 7583, 6105, 4627, 3149, 1671, 193, 11004, 9526, 8048, 6570, 5092, 3614, 2136, 658, 11469, 9991, 8513, 7035, 5557, 4079, 2601, 1123, 11934, 10456, 8978, 7500, 6022, 4544, 3066, 1588, 110, 10921, 9443, 7965, 6487, 5009, 3531, 2053, 575, 11386, 9908, 8430, 6952, 5474, 3996, 2518, 1040, 11851, 10373, 8895, 7417, 5939, 4461, 2983, 1505, 27, 10838, 9360, 7882, 6404,
      9954, 11434, 625, 2105, 3585, 5065, 6545, 8025, 9505, 10985, 176, 1656, 3136, 4616, 6096, 7576, 9056, 10536, 12016, 1207, 2687, 4167, 5647, 7127, 8607, 10087, 11567, 758, 2238, 3718, 5198, 6678, 8158, 9638, 11118, 309, 1789, 3269, 4749, 6229, 7709, 9189, 10669, 12149, 1340, 2820, 4300, 5780, 7260, 8740, 10220, 11700, 891, 2371, 3851, 5331, 6811, 8291, 9771, 11251, 442, 1922, 3402, 4882, 6362, 7842, 9322, 10802, 12282, 1473, 2953, 4433, 5913, 7393, 8873, 10353, 11833, 1024, 2504, 3984, 5464, 6944, 8424, 9904, 11384, 575, 2055, 3535, 5015, 6495, 7975, 9455, 10935, 126, 1606, 3086, 4566, 6046, 7526, 9006, 10486, 11966, 1157, 2637, 4117, 5597, 7077, 8557, 10037, 11517, 708, 2188, 3668, 5148, 6628, 8108, 9588, 11068, 259, 1739, 3219, 4699, 6179, 7659, 9139, 10619, 12099, 1290,
      2770, 4250, 5730, 7210, 8690, 10170, 11650, 841, 2321, 3801, 5281, 6761, 8241, 9721, 11201, 392, 1872, 3352, 4832, 6312, 7792, 9272, 10752, 12232, 1423, 2903, 4383, 5863, 7343, 8823, 10303, 11783, 974, 2454, 3934, 5414, 6894, 8374, 9854, 11334, 525, 2005, 3485, 4965, 6445, 7925, 9405, 10885, 76, 1556, 3036, 4516, 5996, 7476, 8956, 10436, 11916, 1107, 2587, 4067, 5547, 7027, 8507, 9987, 11467, 658, 2138, 3618, 5098, 6578, 8058, 9538, 11018, 209, 1689, 3169, 4649, 6129, 7609, 9089, 10569, 12049, 1240, 2720, 4200, 5680, 7160, 8640, 10120, 11600, 791, 2271, 3751, 5231, 6711, 8191, 9671, 11151, 342, 1822, 3302, 4782, 6262, 7742, 9222, 10702, 12182, 1373, 2853, 4333, 5813, 7293, 8773, 10253, 11733, 924, 2404, 3884, 5364, 6844, 8324, 9804, 11284, 475, 1955, 3435, 4915, 6395]


# ffta=[2638, 1952, 1266, 580, 3223, 2537, 1851, 1165, 479, 3122, 2436, 1750, 1064, 378, 3021, 2335, 1649, 963, 277, 2920, 2234, 1548, 862, 176, 2819, 2133, 1447, 761, 75, 2718, 2032, 1346,
#       660, 3303, 2617, 1931, 1245, 559, 3202, 2516, 1830, 1144, 458, 3101, 2415, 1729, 1043, 357, 3000, 2314, 1628, 942, 256, 2899, 2213, 1527, 841, 155, 2798, 2112, 1426, 740, 54, 2697,
#       691, 1379, 2067, 2755, 114, 802, 1490, 2178, 2866, 225, 913, 1601, 2289, 2977, 336, 1024, 1712, 2400, 3088, 447, 1135, 1823, 2511, 3199, 558, 1246, 1934, 2622, 3310, 669, 1357, 2045,
#       2733, 92, 780, 1468, 2156, 2844, 203, 891, 1579, 2267, 2955, 314, 1002, 1690, 2378, 3066, 425, 1113, 1801, 2489, 3177, 536, 1224, 1912, 2600, 3288, 647, 1335, 2023, 2711, 70, 758]



